# Detect the operating system
# Makevars may not run in a shell so no OSTYPE
UNAME_S := $(shell uname -s)

# Set the extension based on the operating system
ifeq ($(UNAME_S),Darwin)
    LIB_EXT = dylib
else
    LIB_EXT = so
endif

# Needed for readCon
CXX_STD = CXX17
LDFLAGS = -L$(shell pwd)
# On macos, with conda, we need disable_availability
# https://conda-forge.org/docs/maintainer/knowledge_base.html#newer-c-features-with-old-sdk
PKG_CPPFLAGS = -I./../readCon/CppCore -D_LIBCPP_DISABLE_AVAILABILITY
PKG_LDFLAGS = -L${CONDA_PREFIX}/lib
PKG_LDLIBS = -lreadcon
PKG_LIBS = ${CONDA_PREFIX}/lib/libreadcon.$(LIB_EXT)
